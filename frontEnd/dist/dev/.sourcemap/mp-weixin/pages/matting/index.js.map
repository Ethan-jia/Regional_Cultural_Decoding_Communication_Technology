{"version":3,"sources":["uni-app:///src/main.js","webpack:///./src/pages/matting/index.vue?5880","webpack:///./src/pages/matting/index.vue?5369","webpack:///./src/pages/matting/index.vue?42b6","webpack:///./src/pages/matting/index.vue?c9ee","uni-app:///src/pages/matting/index.vue","webpack:///./src/pages/matting/index.vue?3d0d","webpack:///./src/pages/matting/index.vue?1b85"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","videoSrc","templateSrc","step1","step1_success","step2","step2_success","step3","bg_pic","openId","secretKey","platform","components","onLoad","option","console","methods","handlePopup","uni","title","icon","close","handleGoChooseTemp","url","handleTakeVideo","handleSrc","mask","filePath","header","name","formData","success","duration","setTimeout","fail","handleChooseVideo","sourceType","res","self"],"mappings":"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","file":"pages/matting/index.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/matting/index.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./index.vue?vue&type=template&id=7ca58fa8&\"\nvar renderjs\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&lang=scss&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/matting/index.vue\"\nexport default component.exports","export * from \"-!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--15-0!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=template&id=7ca58fa8&\"","var components\ntry {\n  components = {\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"node-modules/@dcloudio/uni-ui/lib/uni-popup/uni-popup\" */ \"@dcloudio/uni-ui/lib/uni-popup/uni-popup.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--13-1!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=script&lang=js&\"","<template>\r\n    <view class=\"matting-wrap\">\r\n        <view class=\"matting-step content1\">\r\n            <img v-if=\"!templateSrc\" :src=\"step1\" @click=\"handleGoChooseTemp\" class=\"step1\" />\r\n            <img v-else :src=\"step1_success\" @click=\"handleGoChooseTemp\" class=\"step1\" />\r\n        </view>\r\n        <view class=\"matting-step content2\">\r\n            <img v-if=\"!videoSrc\" :src=\"step2\" class=\"step2\" @click=\"handlePopup\" />\r\n            <img v-else :src=\"step2_success\" class=\"step2\" @click=\"handlePopup\" />\r\n            <uni-popup ref=\"popup\" background-color=\"rgb(243,243,243)\" :is-mask-click=\"true\">\r\n                <view class=\"recording-content\">\r\n                    <button class=\"recording\" @click=\"handleTakeVideo\">录制</button>\r\n                    <button class=\"selecting\" @click=\"handleChooseVideo\">从手机相册选择</button>\r\n                    <button @click=\"close\" class=\"canceling\">取消</button>\r\n                </view>\r\n            </uni-popup>\r\n\r\n        </view>\r\n        <view class=\"matting-step content3\">\r\n            <img :src=\"step3\" class=\"step3\" @click=\"handleSrc\" />\r\n        </view>\r\n        <view class=\"bottom-content\">\r\n            <img :src=\"bg_pic\" class=\"bottom-pic\" />\r\n        </view>\r\n    </view>\r\n</template>\r\n\r\n<script>\r\n\r\n\r\nexport default {\r\n    data() {\r\n        return {\r\n            videoSrc: \"\",\r\n            templateSrc: \"\",\r\n            step1: this.baseUrl + '/image/matting/step1.png/',\r\n            step1_success: this.baseUrl + '/image/matting/step1_success.png/',\r\n            step2: this.baseUrl + '/image/matting/step2.png/',\r\n            step2_success: this.baseUrl + '/image/matting/step2_success.png/',\r\n            step3: this.baseUrl + '/image/matting/step3.png/',\r\n            bg_pic: this.baseUrl + '/image/bg_pic.png/',\r\n            openId:\"\",\r\n            secretKey:\"\",\r\n            platform:\"\",\r\n\r\n\r\n        };\r\n    },\r\n    components: {},\r\n    onLoad(option) {\r\n        this.templateSrc = option.templateSrc;   \r\n        this.videoSrc = option.videoSrc;\r\n\r\n        this.openId = uni.getStorageSync(\"openId\")\r\n        this.secretKey = uni.getStorageSync(\"secretKey\")\r\n        this.platform = uni.getSystemInfoSync().platform\r\n        console.log(this.platform);\r\n    },\r\n\r\n    methods: {\r\n        handlePopup() {\r\n            if(!this.templateSrc){\r\n                uni.showToast({\r\n                    title: \"请先选择模板\",\r\n                    icon: \"error\",\r\n                });\r\n            }\r\n            else if (this.templateSrc !==\"2\") {\r\n                this.$refs.popup.open(\"bottom\");\r\n            } \r\n            else if (this.templateSrc ===\"2\"){\r\n                this.handleTakeVideo()\r\n            }\r\n           \r\n\r\n        },\r\n        close() {\r\n            this.$refs.popup.close();\r\n        },\r\n        handleGoChooseTemp() {\r\n            uni.navigateTo({\r\n                url: \"/pages/chooseTemp/index?templateId=1\",\r\n            });\r\n        },\r\n        handleTakeVideo() {\r\n            uni.navigateTo({\r\n                url: \"/pages/matting/takeVideo?templateSrc=\" + this.templateSrc\r\n            })\r\n            // var self = this;\r\n            // uni.chooseMedia({\r\n            //     count:1,\r\n            //     mediaType:['video'],\r\n            //     sourceType: [\"camera\"],\r\n            //     maxDuration: 15,\r\n            //     success(res) {\r\n            //         self.videoSrc = res.tempFiles[0].tempFilePath;\r\n            //         self.height = res.tempFiles[0].height\r\n            //         self.width = res .tempFiles[0].width\r\n            //         console.log(self.videoSrc);\r\n            //         self.close();\r\n\r\n            //     },\r\n            //     fail(res) {\r\n            //         console.log(res);\r\n            //     },\r\n            // });\r\n\r\n        },\r\n        handleSrc() {\r\n            if (!this.videoSrc && !this.templateSrc) {\r\n                uni.showToast({\r\n                    title: \"请上传视频模板\",\r\n                    icon: \"error\",\r\n                });\r\n            } else if (!this.videoSrc) {\r\n                uni.showToast({\r\n                    title: \"请上传视频\",\r\n                    icon: \"error\",\r\n                });\r\n            } else {\r\n                //打开loading等待\r\n\r\n                console.log(this.videoSrc);\r\n                console.log(\"----------------\");\r\n                uni.showLoading({ mask: true, title: \"上传中...\" })               \r\n                uni.uploadFile({\r\n                    url: this.baseUrl + '/videos/upload/',\r\n                    filePath: this.videoSrc,\r\n                    header:this.header,\r\n                    name: 'file',\r\n                    formData: {\r\n                        'openId': this.openId,\r\n                        'secretKey': this.secretKey,\r\n                        'videoName':this.videoSrc,\r\n                        \"template\": this.templateSrc,\r\n                        \"type\": \"matting\",\r\n                        \"platform\" : this.platform\r\n\r\n                    },\r\n                    success: (uploadFileRes) => {\r\n                        console.log(uploadFileRes.data);\r\n                        console.log(\"success!\");\r\n                        if (JSON.parse(uploadFileRes.data).code == \"OK\") {\r\n                            //关闭loading\r\n                            uni.hideLoading()\r\n                            uni.showToast({\r\n                                title: \"上传成功！\",\r\n                                duration: 1500,\r\n                            });\r\n                            setTimeout(() => {\r\n                                    uni.navigateTo({\r\n                                        url: \"/pages/videoPlay/videoPreview?templateSrc=\"+this.templateSrc+\"&templateId=1\"\r\n                                    })\r\n                                }, 2000)\r\n                           \r\n                        }\r\n                        else {\r\n                            uni.hideLoading();\r\n                            uni.showToast({\r\n                                title: \"上传失败！\",\r\n                                icon: \"error\",\r\n\r\n                            });\r\n                        }\r\n\r\n                    },\r\n                    fail: (e) => {\r\n                        console.log(e);\r\n                        uni.hideLoading()\r\n                        uni.showToast({\r\n                            title: \"上传失败！\",\r\n                            icon: \"error\",\r\n\r\n                        });\r\n                    }\r\n                });\r\n\r\n            }\r\n        },\r\n        handleChooseVideo() {\r\n\r\n            var self = this;\r\n            uni.chooseVideo({\r\n                sourceType: [\"album\"],\r\n                // compressed: True,\r\n                success(res) {\r\n                    self.videoSrc = res.tempFilePath;\r\n                    console.log(self.videoSrc);\r\n                    self.close();\r\n                },\r\n                fail(res) {\r\n                    console.log(res);\r\n                },\r\n            });\r\n\r\n\r\n        },\r\n    },\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n.matting-wrap {\r\n    width: 100vw;\r\n    position: absolute;\r\n\r\n    .matting-step {\r\n        text-align: center;\r\n\r\n        .uni-popup {\r\n            border-top-left-radius: 10%;\r\n            border-top-right-radius: 10%;\r\n        }\r\n\r\n        .recording-content {\r\n            .recording {\r\n                background-color: rgb(243, 243, 243);\r\n            }\r\n\r\n            .recording::after {\r\n                border-bottom: none;\r\n            }\r\n\r\n            .selecting {\r\n                background-color: rgb(243, 243, 243);\r\n                border-top: none;\r\n            }\r\n\r\n            .canceling {\r\n                background-color: rgb(243, 243, 243);\r\n            }\r\n\r\n            .canceling::after {\r\n                border-bottom: none;\r\n            }\r\n        }\r\n\r\n        .step1 {\r\n            width: 90vw;\r\n            height: 20vh;\r\n            margin-top: 5%;\r\n        }\r\n\r\n        .step2 {\r\n            width: 90vw;\r\n            height: 20vh;\r\n            margin-top: 2%;\r\n        }\r\n\r\n        .step3 {\r\n            width: 90vw;\r\n            height: 18vh;\r\n            margin-top: 2%;\r\n        }\r\n    }\r\n\r\n    .bottom-content {\r\n        .bottom-pic {\r\n            width: 100vw;\r\n            height: 35vh;\r\n            position: fixed;\r\n            bottom: 0;\r\n        }\r\n    }\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--9-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--9-oneOf-1-5!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--9-oneOf-1-2!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-3!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--9-oneOf-1-5!../../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./index.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1669620168620\n      var cssReload = require(\"E:/code/workSpace/project/lingting_travel/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}